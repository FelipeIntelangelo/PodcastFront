<form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div id="form-container">
        <h2>Sign Up</h2>
        @if (currentStep === 1) {
            <h3>Account Data</h3>
            <div id="fieldsetContainer">
                <div class="fieldsetUp">
                    <fieldset>
                        <label for="usernameIn">Username:</label>
                        <input type="text" id="usernameIn" placeholder="username" formControlName="username">
                        <app-form-error controlName="username" [customMessages]="customErrors['username']" />
                    </fieldset>
                    <fieldset>
                        <label for="passwordIn">Password:</label>
                        <input type="password" id="passwordIn" placeholder="password" formControlName="password">
                        <app-form-error controlName="password" [customMessages]="customErrors['password']" />
                    </fieldset>
                    <fieldset>
                        <label for="emailIn">Email:</label>
                        <input type="email" id="emailIn" placeholder="email" formControlName="email">
                        <app-form-error controlName="email" [customMessages]="customErrors['email']" />
                    </fieldset>
                </div>
            </div>
            <div id="buttonContainer">
                <button type="button" [disabled]="isSubmitting || 
                    !registerForm.get('username')?.valid
                    || !registerForm.get('email')?.valid
                    || !registerForm.get('password')?.valid"
                     (click)="nextStep()">Next Step</button>
                <p>Have an account?<a routerLink="/auth/login" id="loginRoute"> Sign in</a></p>
            </div>
        } @else if (currentStep === 2) {
            <h3>Personal Information</h3>
            <div id="buttonContainer">
                <button type="button" (click)="prevStep()">Back</button>
            </div>
            <div id="fieldsetContainer">
                <div class="fieldsetUp">
                    <fieldset>
                        <label for="nameIn">Name:</label>
                        <input type="text" id="nameIn" placeholder="name" formControlName="name">
                        <app-form-error controlName="name" [customMessages]="customErrors['name']" />
                    </fieldset>
                    <fieldset>
                        <label for="lastNameIn">Last Name:</label>
                        <input type="text" id="lastNameIn" placeholder="last name" formControlName="lastName">
                        <app-form-error controlName="lastName" [customMessages]="customErrors['lastName']" />
                    </fieldset>
                    <fieldset>
                        <label for="nickname">Nickname:</label>
                        <input type="text" id="nicknameIn" placeholder="nickname" formControlName="nickname">
                        <app-form-error controlName="nickname" [customMessages]="customErrors['nickname']" />
                    </fieldset>
                </div>
            </div>
            <div id="buttonContainer">
                <button type="submit" [disabled]="isSubmitting">{{ isSubmitting ? 'Registrando...' : 'Register' }}</button>
                @if (isSubmitting) {
                    <span class="spinner" aria-hidden="true"></span>
                }
                @if (errorMessage) {
                    <p class="server-error">{{ errorMessage }}</p>
                }
                <p>Have an account?<a routerLink="/auth/login" id="loginRoute"> Sign in</a></p>
            </div>
        }
    </div>
</form>